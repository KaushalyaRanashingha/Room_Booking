<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>

  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
  <!-- Small custom overrides -->
  <link rel="stylesheet" href="/admin.css">
</head>

<body class="bg-light">
<div class="d-flex min-vh-100">


    <div class="flex-grow-1 d-flex flex-column">
      <%- include("navbar") %>
      
      <main class="container-fluid py-3">
        <!-- Header -->
        <div class="d-flex flex-wrap justify-content-between align-items-end mb-3">
          <div>
            <h1 class="h3 mb-1">Dashboard</h1>
            <p class="text-muted mb-0">
              Overview of users, rooms, bookings, and payments.
            </p>

  <%- include("sidebar") %>

  <div class="flex-grow-1 d-flex flex-column">
    <%- include("navbar") %>

    <main class="container-fluid py-3">

      <!-- Header -->
      <div class="d-flex justify-content-between align-items-end mb-3">
        <div>
          <h1 class="h3 mb-1">Dashboard</h1>
          <p class="text-muted mb-0">Overview of users, rooms, bookings, and payments.</p>
        </div>
      </div>

      <!-- Stat Cards -->
      <section class="row g-3 mb-3">

        <div class="col-md-3">
          <div class="card shadow-sm">
            <div class="card-body">
              <h6>Total Users</h6>
              <h4><%= user %></h4>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card shadow-sm">
            <div class="card-body">
              <h6>Total Rooms</h6>
              <h4><%= room %></h4>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card shadow-sm">
            <div class="card-body">
              <h6>Approved Bookings</h6>
              <h4><%= booking %></h4>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card shadow-sm">
            <div class="card-body">
              <h6>Total Payments</h6>
              <h4><%= payment %></h4>
            </div>
          </div>
        </div>

      </section>

      <!-- Recent Bookings -->
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="mb-3">Recent Bookings</h5>

          <table class="table table-bordered table-striped">
            <thead class="table-light">
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Mobile</th>
                <th>Room</th>
                <th>Price</th>
                <th>Check-in</th>
                <th>Check-out</th>
                <th>Status</th>
              </tr>
            </thead>

            <tbody>
              <% if (recentBookings.length === 0) { %>
                <tr>
                  <td colspan="8" class="text-center">No bookings yet</td>
                </tr>
              <% } %>

              <% recentBookings.forEach(b => { %>
                <tr>
                  <td><%= b.name %></td>
                  <td><%= b.email %></td>
                  <td><%= b.mobile %></td>
                  <td>
                    Room <%= b.room?.roomNumber %> (<%= b.room?.type %>)
                  </td>
                  <td>LKR <%= b.room?.price %></td>
                  <td><%= b.checkin.toDateString() %></td>
                  <td><%= b.checkout.toDateString() %></td>
                  <td>
                    <span class="badge bg-<%= b.status === 'Approved' ? 'success' : 'warning' %>">
                      <%= b.status %>
                    </span>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>

        </div>
      </div>

    </main>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
